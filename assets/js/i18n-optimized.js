class I18n{constructor(){this.currentLang="zh-CN",this.keysForInnerHTML=["chat_header","banner_title"],this.init()}init(){this.btnZh=document.getElementById("btnZh"),this.btnEn=document.getElementById("btnEn"),this.statsIframe=document.querySelector(".stats-widget-iframe"),this.btnZh&&this.btnEn&&(this.btnZh.addEventListener("click",()=>this.updateLanguage("zh-CN")),this.btnEn.addEventListener("click",()=>this.updateLanguage("en"))),this.updateLanguage("zh-CN")}updateLanguage(t){if(translations[t]){if(this.currentLang=t,document.documentElement.lang=t,document.querySelectorAll("[data-i18n]").forEach(n=>{const e=n.getAttribute("data-i18n"),a=translations[t][e]||n.textContent;this.keysForInnerHTML.includes(e)?n.innerHTML=a:n.textContent=a,"banner_title"===e&&n.setAttribute("data-lang",t)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(n=>{const e=n.getAttribute("data-i18n-placeholder");translations[t][e]&&(n.placeholder=translations[t][e])}),document.querySelectorAll("*").forEach(n=>{for(const e of n.attributes)if(e.name.startsWith("data-i18n-attr-")){const a=e.name.substring(15),s=e.value;translations[t][s]&&n.setAttribute(a,translations[t][s])}}),this.btnZh&&this.btnEn&&(this.btnZh.classList.toggle("active","zh-CN"===t),this.btnEn.classList.toggle("active","en"===t)),document.title=translations[t].title,this.statsIframe&&this.statsIframe.contentWindow)try{this.statsIframe.contentWindow.postMessage({type:"setLang",lang:t},"*")}catch(t){console.warn("Could not communicate with stats iframe:",t)}document.dispatchEvent(new CustomEvent("languageChanged",{detail:{lang:t}}))}else console.warn(`Language ${t} not found in translations`)}getCurrentLanguage(){return this.currentLang}}document.addEventListener("DOMContentLoaded",()=>{window.i18n=new I18n});