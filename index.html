<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title data-i18n="title">硅谷科技评论</title>
  <style>
    /* 省略原样式，保持你的CSS不变 */
  </style>
</head>
<body>
  <div class="lang-toggle">
    <button id="btnZh" class="active">中</button>
    <button id="btnEn">Eng</button>
  </div>
  <button class="menu-toggle">☰</button>
  <div class="overlay active"></div>
  <aside class="sidebar open">
    <!-- 侧边栏内容保持不变 -->
  </aside>
  <main class="content shifted">
    <div class="wrapper">
      <div class="banner-header"></div>
    </div>
    <section class="notice wrapper">
      <!-- 公告内容保持不变 -->
    </section>
    <section class="chatbox wrapper">
      <div class="chat-header">
        Chat with <a href="https://c0uiiy15npu.feishu.cn/wiki/TB4nwFKSjiZybRkoZx7c7mBXnxd?from=from_copylink" target="_blank">SVTR.AI</a>
      </div>
      <div class="chat-history" style="flex-direction:column;">
        <form id="waitlistInlineForm" style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
          <span class="join-btn" id="joinBtn" data-i18n="join_btn" style="padding:.55rem 1.2rem; font-size:1rem; cursor:default; pointer-events:none; box-shadow:none;">加入候补名单</span>
          <input type="email" id="waitlistInlineEmail" placeholder="请输入您的邮箱" data-i18n-placeholder="waitlist_email_placeholder" required style="padding:7px 12px; border-radius:4px; border:1px solid #ece6dd; background:#fff8e1; font-size:15px;"/>
          <button type="submit" class="join-btn" style="padding:.55rem 1.2rem; font-size:1rem;" data-i18n="waitlist_submit_btn">提交</button>
        </form>
        <div class="message" id="waitlistInlineSuccessMsg" style="color:var(--waitlist-success); min-height:22px; font-size:15px;"></div>
        <div class="error" id="waitlistInlineErrorMsg" style="color:var(--waitlist-error); min-height:22px; font-size:15px;"></div>
      </div>
      <div class="chat-input-area">
        <textarea placeholder="" data-i18n-placeholder="input_placeholder"></textarea>
        <button type="button" data-i18n="send_btn"></button>
      </div>
    </section>
    <div style="text-align:center; color:#666; margin:20px 0;" data-i18n="footer_text"></div>
  </main>
  <script>
    const translations = {
      'zh-CN': {
        title: '硅谷科技评论',
        sidebar_title: '硅谷科技评论',
        nav_ai100: 'AI 100',
        nav_ranking: 'AI创投榜',
        sub_financing: '融资概览',
        sub_industries: '赛道概览',
        sub_startups: '公司概览',
        sub_investors: '机构概览',
        sub_people: '人员概览',
        nav_database: 'AI创投库',
        nav_group: 'AI创投群',
        nav_meetup: 'AI创投会',
        nav_camp: 'AI创投营',
        nav_about: '关于我们',
        sidebar_qr_text: '添加好友，进群交流',
        notice_1: '如果您是AI从业者，欢迎加入硅谷科技评论（SVTR.AI）',
        link_community: '创投社区',
        notice_2: '如果您是AI创始人，欢迎加入硅谷科技评论（SVTR.AI）',
        link_alliance: '生态联盟',
        notice_3: '如果您是权益会员，请移步硅谷科技评论（SVTR.AI）',
        link_members: '权益会员专区',
        chat_header: 'Chat with SVTR.AI',
        join_btn: '加入候补名单',
        input_placeholder: '请输入你的问题...',
        send_btn: '发送',
        footer_text: '© 2025 SVTR.AI. All rights reserved.',
        waitlist_email_placeholder: '请输入您的邮箱',
        waitlist_submit_btn: '提交'
      },
      'en': {
        title: 'SVTR.AI',
        sidebar_title: 'SVTR.AI',
        nav_ai100: 'AI 100',
        nav_ranking: 'AI Ranking',
        sub_financing: 'Financing',
        sub_industries: 'Industries',
        sub_startups: 'Startups',
        sub_investors: 'Investors',
        sub_people: 'People',
        nav_database: 'AI Database',
        nav_group: 'AI Group',
        nav_meetup: 'AI Meetup',
        nav_camp: 'AI Camp',
        nav_about: 'About',
        sidebar_qr_text: 'Scan QR to join chat',
        notice_1: 'If you are an AI Practitioner, welcome to join SVTR.AI',
        link_community: 'Community',
        notice_2: 'If you are an AI Founder, welcome to join SVTR.AI',
        link_alliance: 'Ecosystem Alliance',
        notice_3: 'If you are a Member, please visit SVTR.AI',
        link_members: 'Exclusive Members Area',
        chat_header: 'Chat with SVTR.AI',
        join_btn: 'Join the Waitlist',
        input_placeholder: 'Type your question...',
        send_btn: 'Send',
        footer_text: '© 2025 SVTR.AI. All rights reserved.',
        waitlist_email_placeholder: 'Enter your email',
        waitlist_submit_btn: 'Submit'
      }
    };

    function updateLanguage(lang) {
      document.documentElement.lang = lang;
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = translations[lang][key] || el.textContent;
      });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        el.placeholder = translations[lang][key] || el.placeholder;
      });
      document.getElementById('btnZh').classList.toggle('active', lang === 'zh-CN');
      document.getElementById('btnEn').classList.toggle('active', lang === 'en');
    }

    document.getElementById('btnZh').addEventListener('click', () => updateLanguage('zh-CN'));
    document.getElementById('btnEn').addEventListener('click', () => updateLanguage('en'));

    const toggle = document.querySelector('.menu-toggle');
    const sidebar = document.querySelector('.sidebar');
    const overlay = document.querySelector('.overlay');
    const content = document.querySelector('.content');

    toggle.addEventListener('click', () => {
      sidebar.classList.toggle('open');
      overlay.classList.toggle('active');
      content.classList.toggle('shifted');
    });
    overlay.addEventListener('click', () => {
      sidebar.classList.remove('open');
      overlay.classList.remove('active');
      content.classList.remove('shifted');
    });

    // initialize
    updateLanguage('zh-CN');

    // Automatically close sidebar after 2 seconds
    setTimeout(() => {
      const sidebarElement = document.querySelector('.sidebar');
      const overlayElement = document.querySelector('.overlay');
      const contentElement = document.querySelector('.content');
      if (sidebarElement && overlayElement && contentElement) {
        sidebarElement.classList.remove('open');
        overlayElement.classList.remove('active');
        contentElement.classList.remove('shifted');
      }
    }, 2000);

    // Inline waitlist form submit
    document.getElementById('waitlistInlineForm').onsubmit = async function(e) {
      e.preventDefault();
      const email = document.getElementById('waitlistInlineEmail').value.trim();
      const successMsg = document.getElementById('waitlistInlineSuccessMsg');
      const errorMsg = document.getElementById('waitlistInlineErrorMsg');
      successMsg.textContent = '';
      errorMsg.textContent = '';
      if (!email) {
        errorMsg.textContent = translations[document.documentElement.lang]['waitlist_email_placeholder'] || '请输入有效的邮箱地址。';
        return;
      }
      // 邮箱格式简单校验
      if (!/^[\w\-\.]+@[\w\-]+\.[\w\-\.]+$/.test(email)) {
        errorMsg.textContent = document.documentElement.lang === 'en' ? 'Invalid email format.' : '邮箱格式不正确。';
        return;
      }
      try {
        const res = await fetch('https://waitlist-api.liumin-gsm.workers.dev/', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email })
        });
        const data = await res.json();
        if (data.ok) {
          successMsg.textContent = document.documentElement.lang === 'en' ? 'Successfully submitted, thank you!' : '提交成功，感谢您的预约！';
          document.getElementById('waitlistInlineForm').reset();
        } else {
          errorMsg.textContent = data.error || (document.documentElement.lang === 'en' ? 'Submission failed, please try again.' : '提交失败，请稍后重试。');
        }
      } catch {
        errorMsg.textContent = document.documentElement.lang === 'en' ? 'Submission failed, please try again.' : '提交失败，请稍后重试。';
      }
    };
  </script>
</body>
</html>
