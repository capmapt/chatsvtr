<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SEOå®æ—¶æ£€æŸ¥å·¥å…·</title>
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; margin: 0; padding: 20px; background: #f8fafc; }
    .container { max-width: 800px; margin: 0 auto; }
    .card { background: white; border-radius: 12px; padding: 24px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
    .title { font-size: 20px; font-weight: 700; margin-bottom: 16px; color: #1e293b; }
    .check-item { display: flex; align-items: center; padding: 12px; margin-bottom: 8px; border-radius: 8px; font-size: 14px; }
    .check-item.pass { background: #dcfce7; color: #166534; }
    .check-item.fail { background: #fef2f2; color: #991b1b; }
    .check-item.warn { background: #fef3c7; color: #92400e; }
    .icon { margin-right: 8px; font-weight: bold; }
    .value { font-family: monospace; background: rgba(0,0,0,0.05); padding: 2px 6px; border-radius: 4px; margin-left: 8px; }
    .btn { background: #3b82f6; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 14px; }
    .btn:hover { background: #2563eb; }
    .lang-toggle { margin-bottom: 16px; }
    .lang-btn { padding: 8px 16px; border: 1px solid #ddd; background: white; cursor: pointer; margin-right: 8px; border-radius: 4px; }
    .lang-btn.active { background: #3b82f6; color: white; border-color: #3b82f6; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <div class="title">ğŸ” SVTR.AI SEOå®æ—¶æ£€æŸ¥</div>
      <div class="lang-toggle">
        <button class="lang-btn active" onclick="checkSEO('zh-CN')" id="btn-zh">ä¸­æ–‡æ£€æŸ¥</button>
        <button class="lang-btn" onclick="checkSEO('en')" id="btn-en">English Check</button>
      </div>
      <div style="margin: 16px 0;">
        <label style="margin-right: 10px;">æ£€æŸ¥é¡µé¢:</label>
        <select id="pageSelect" onchange="updateCheckUrl()">
          <option value="/">ä¸»é¡µ (index.html)</option>
          <option value="/pages/ai-weekly.html">AIå‘¨æŠ¥</option>
          <option value="/pages/trading-picks.html">äº¤æ˜“ç²¾é€‰</option>
          <option value="/pages/ai-100.html">AI 100</option>
        </select>
      </div>
      <button class="btn" onclick="runFullCheck()">è¿è¡Œå®Œæ•´æ£€æŸ¥</button>
      <div id="status" style="margin-top: 10px; font-size: 14px; color: #666;"></div>
    </div>

    <div class="card">
      <div class="title">ğŸ“Š åŸºç¡€SEOæ£€æŸ¥</div>
      <div id="basic-checks"></div>
    </div>

    <div class="card">
      <div class="title">ğŸŒ ç¤¾äº¤åª’ä½“æ£€æŸ¥</div>
      <div id="social-checks"></div>
    </div>

    <div class="card">
      <div class="title">ğŸ¢ ç»“æ„åŒ–æ•°æ®æ£€æŸ¥</div>
      <div id="schema-checks"></div>
    </div>

    <div class="card">
      <div class="title">âš¡ æ€§èƒ½æ£€æŸ¥</div>
      <div id="performance-checks"></div>
    </div>
  </div>

  <script>
    let currentCheckUrl = '/';
    let pageData = null;

    function createCheckItem(status, text, value = '') {
      const icons = { pass: 'âœ…', fail: 'âŒ', warn: 'âš ï¸' };
      return `
        <div class="check-item ${status}">
          <span class="icon">${icons[status]}</span>
          <span>${text}</span>
          ${value ? `<span class="value">${value}</span>` : ''}
        </div>
      `;
    }

    function updateCheckUrl() {
      currentCheckUrl = document.getElementById('pageSelect').value;
      document.getElementById('status').innerHTML = `æ­£åœ¨æ£€æŸ¥: ${currentCheckUrl}`;
      runFullCheck();
    }

    async function fetchPageData(url) {
      try {
        document.getElementById('status').innerHTML = `æ­£åœ¨è·å–é¡µé¢æ•°æ®: ${url}`;
        const response = await fetch(url);
        const html = await response.text();
        
        // åˆ›å»ºä¸´æ—¶DOMæ¥è§£æHTML
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        return doc;
      } catch (error) {
        console.error('è·å–é¡µé¢æ•°æ®å¤±è´¥:', error);
        document.getElementById('status').innerHTML = `âŒ è·å–é¡µé¢æ•°æ®å¤±è´¥: ${error.message}`;
        return null;
      }
    }

    function checkSEO(lang) {
      // Update active button
      document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById(`btn-${lang === 'zh-CN' ? 'zh' : 'en'}`).classList.add('active');
      
      // Simulate language change (in real app, this would trigger i18n)
      if (window.i18n) {
        window.i18n.updateLanguage(lang);
      }
      
      setTimeout(() => runFullCheck(), 100);
    }

    async function runFullCheck() {
      pageData = await fetchPageData(currentCheckUrl);
      if (pageData) {
        checkBasicSEO();
        checkSocialMedia();
        checkStructuredData();
        checkPerformance();
        document.getElementById('status').innerHTML = `âœ… æ£€æŸ¥å®Œæˆ: ${currentCheckUrl}`;
      }
    }

    function checkBasicSEO() {
      const container = document.getElementById('basic-checks');
      let checks = '';
      
      if (!pageData) {
        container.innerHTML = createCheckItem('fail', 'æ— æ³•è·å–é¡µé¢æ•°æ®', 'è¯·åˆ·æ–°é¡µé¢é‡è¯•');
        return;
      }
      
      // Check title
      const titleElement = pageData.querySelector('title');
      const title = titleElement ? titleElement.textContent : '';
      if (title && title.length >= 30 && title.length <= 60) {
        checks += createCheckItem('pass', 'é¡µé¢æ ‡é¢˜é•¿åº¦é€‚ä¸­', `${title.length}å­—ç¬¦`);
      } else {
        checks += createCheckItem('warn', 'é¡µé¢æ ‡é¢˜é•¿åº¦ä¸å½“æˆ–ç¼ºå¤±', `${title ? title.length : 0}å­—ç¬¦`);
      }
      
      // Check meta description
      const desc = pageData.querySelector('meta[name="description"]');
      if (desc && desc.content.length >= 75 && desc.content.length <= 160) {
        checks += createCheckItem('pass', 'Metaæè¿°é•¿åº¦é€‚ä¸­', `${desc.content.length}å­—ç¬¦`);
      } else {
        checks += createCheckItem('warn', 'Metaæè¿°é•¿åº¦ä¸å½“æˆ–ç¼ºå¤±', `${desc ? desc.content.length : 0}å­—ç¬¦`);
      }
      
      // Check canonical
      const canonical = pageData.querySelector('link[rel="canonical"]');
      checks += createCheckItem(canonical ? 'pass' : 'fail', 'Canonicalé“¾æ¥', canonical ? canonical.href : 'ç¼ºå¤±');
      
      // Check robots meta
      const robots = pageData.querySelector('meta[name="robots"]');
      checks += createCheckItem(robots ? 'pass' : 'warn', 'RobotsæŒ‡ä»¤', robots ? robots.content : 'æœªè®¾ç½®');
      
      container.innerHTML = checks;
    }

    function checkSocialMedia() {
      const container = document.getElementById('social-checks');
      let checks = '';
      
      if (!pageData) {
        container.innerHTML = createCheckItem('fail', 'æ— æ³•è·å–é¡µé¢æ•°æ®', '');
        return;
      }
      
      // Check Open Graph
      const ogTitle = pageData.querySelector('meta[property="og:title"]');
      const ogDesc = pageData.querySelector('meta[property="og:description"]');
      const ogImage = pageData.querySelector('meta[property="og:image"]');
      
      checks += createCheckItem(ogTitle ? 'pass' : 'fail', 'Open Graphæ ‡é¢˜', ogTitle ? 'å·²è®¾ç½®' : 'ç¼ºå¤±');
      checks += createCheckItem(ogDesc ? 'pass' : 'fail', 'Open Graphæè¿°', ogDesc ? 'å·²è®¾ç½®' : 'ç¼ºå¤±');
      checks += createCheckItem(ogImage ? 'pass' : 'fail', 'Open Graphå›¾ç‰‡', ogImage ? 'å·²è®¾ç½®' : 'ç¼ºå¤±');
      
      // Check Twitter Cards
      const twitterCard = pageData.querySelector('meta[name="twitter:card"]');
      const twitterTitle = pageData.querySelector('meta[name="twitter:title"]');
      
      checks += createCheckItem(twitterCard ? 'pass' : 'fail', 'Twitterå¡ç‰‡ç±»å‹', twitterCard ? twitterCard.content : 'ç¼ºå¤±');
      checks += createCheckItem(twitterTitle ? 'pass' : 'fail', 'Twitteræ ‡é¢˜', twitterTitle ? 'å·²è®¾ç½®' : 'ç¼ºå¤±');
      
      container.innerHTML = checks;
    }

    function checkStructuredData() {
      const container = document.getElementById('schema-checks');
      let checks = '';
      
      if (!pageData) {
        container.innerHTML = createCheckItem('fail', 'æ— æ³•è·å–é¡µé¢æ•°æ®', '');
        return;
      }
      
      // Check JSON-LD
      const jsonLD = pageData.querySelectorAll('script[type="application/ld+json"]');
      if (jsonLD.length > 0) {
        checks += createCheckItem('pass', 'JSON-LDç»“æ„åŒ–æ•°æ®', `${jsonLD.length}ä¸ªè„šæœ¬`);
        
        // Try to parse and validate
        try {
          jsonLD.forEach((script, index) => {
            const data = JSON.parse(script.textContent);
            if (data['@context'] && (data['@type'] || data['@graph'])) {
              const type = data['@type'] || (data['@graph'] ? data['@graph'][0]?.['@type'] : 'æœªçŸ¥');
              checks += createCheckItem('pass', `ç»“æ„åŒ–æ•°æ® #${index + 1}`, `ç±»å‹: ${type}`);
            }
          });
        } catch (e) {
          checks += createCheckItem('fail', 'JSON-LDè§£æé”™è¯¯', e.message);
        }
      } else {
        checks += createCheckItem('fail', 'JSON-LDç»“æ„åŒ–æ•°æ®', 'æœªæ‰¾åˆ°');
      }
      
      container.innerHTML = checks;
    }

    function checkPerformance() {
      const container = document.getElementById('performance-checks');
      let checks = '';
      
      if (!pageData) {
        container.innerHTML = createCheckItem('fail', 'æ— æ³•è·å–é¡µé¢æ•°æ®', '');
        return;
      }
      
      // Check preload links
      const preloads = pageData.querySelectorAll('link[rel="preload"]');
      checks += createCheckItem(preloads.length > 0 ? 'pass' : 'warn', 'èµ„æºé¢„åŠ è½½', `${preloads.length}ä¸ªèµ„æº`);
      
      // Check WebP images
      const webpSources = pageData.querySelectorAll('source[srcset*=".webp"]');
      const webpImages = pageData.querySelectorAll('img[src*=".webp"]');
      const totalWebP = webpSources.length + webpImages.length;
      checks += createCheckItem(totalWebP > 0 ? 'pass' : 'warn', 'WebPå›¾ç‰‡æ ¼å¼', `${totalWebP}ä¸ªå›¾ç‰‡`);
      
      // Check external links with rel
      const externalLinks = pageData.querySelectorAll('a[href^="http"]:not([href*="svtr.ai"]):not([href*="localhost"])');
      const linksWithRel = pageData.querySelectorAll('a[href^="http"]:not([href*="svtr.ai"]):not([href*="localhost"])[rel]');
      const relRatio = externalLinks.length > 0 ? (linksWithRel.length / externalLinks.length * 100).toFixed(0) : 100;
      
      checks += createCheckItem(relRatio >= 80 ? 'pass' : 'warn', 'å¤–éƒ¨é“¾æ¥relå±æ€§', `${relRatio}%è®¾ç½®äº†rel`);
      
      // Check image alt attributes
      const images = pageData.querySelectorAll('img');
      const imagesWithAlt = pageData.querySelectorAll('img[alt]');
      const altRatio = images.length > 0 ? (imagesWithAlt.length / images.length * 100).toFixed(0) : 100;
      
      checks += createCheckItem(altRatio >= 90 ? 'pass' : 'warn', 'å›¾ç‰‡Altå±æ€§', `${altRatio}%è®¾ç½®äº†alt`);
      
      container.innerHTML = checks;
    }

    // Run initial check
    runFullCheck();
    
    // Auto-refresh every 30 seconds
    setInterval(runFullCheck, 30000);
  </script>
</body>
</html>