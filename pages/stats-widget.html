<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>SVTR Stats Widget</title>
<style>
/* === ä¼˜åŒ–çš„ç»Ÿä¸€åŸºç¡€æ ·å¼ === */
*{box-sizing:border-box;margin:0;padding:0}
html,body{
  font-family:Arial,"Microsoft YaHei",sans-serif;
  overflow:hidden;
  height:100vh;
  width:100%;
  background:transparent;
}
body{display:flex;align-items:center;justify-content:center;}

/* ğŸ¯ ç»Ÿä¸€å¸ƒå±€ï¼šæ¶ˆé™¤æ»šåŠ¨æ¡ */
.stats-container{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:15px;
  width:100%;
  max-width:800px;
  margin:0;
  padding:15px;
  box-sizing:border-box;
}

/* ç»Ÿä¸€å¡ç‰‡æ ·å¼ */
.stat-card{
  position:relative;
  text-align:center;
  background:#fff;
  padding:20px 15px;
  border-radius:12px;
  text-decoration:none;
  color:inherit;
  box-shadow:0 6px 18px rgba(0,0,0,.06);
  transition:.3s;
  width:100%;
  min-width:0;
  box-sizing:border-box;
  overflow:hidden;
}

.stat-card:hover{transform:translateY(-3px);box-shadow:0 10px 24px rgba(0,0,0,.10);}

.stat-icon{
  font-size:2.5rem;            /* é€‚ä¸­çš„å›¾æ ‡å¤§å° */
  margin-bottom:12px;
}
.members .stat-icon{color:#6c5ce7}
.companies .stat-icon{color:#0984e3}
.vip .stat-icon{color:#00b894}

.stat-number{
  font-size:2rem;
  font-weight:700;
  color:#2d3436;
  margin-bottom:8px;
  word-wrap:break-word;
  overflow-wrap:break-word;
}

.stat-label{
  font-size:0.95rem;
  color:#636e72;
  margin-bottom:12px;
  line-height:1.3;
  word-wrap:break-word;
  overflow-wrap:break-word;
  hyphens:auto;
  text-overflow:ellipsis;
}

.progress-bar{
  height:5px;
  background:#ddd;
  border-radius:3px;
  overflow:hidden;
  margin-bottom:10px;
}

.progress-fill{height:100%;width:0;transition:width 1s}
.members .progress-fill{background:linear-gradient(45deg,#6c5ce7,#a29bfe)}
.companies .progress-fill{background:linear-gradient(45deg,#0984e3,#74b9ff)}
.vip .progress-fill{background:linear-gradient(45deg,#00b894,#55efc4)}

.live-indicator{
  position:absolute;
  top:12px;
  right:12px;
  font-size:.7rem;
  color:#00b894;
  display:flex;
  align-items:center;
  gap:3px;
}

.live-dot{
  width:6px;
  height:6px;
  border-radius:50%;
  background:#00b894;
  animation:blink 1s infinite
}

@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:.35}}

.growth-indicator{
  font-size:.75rem;
  color:#00b894;
  font-weight:500;
  display:flex;
  justify-content:center;
  gap:3px;
  margin-bottom:0;
}


.increase-animation{animation:flash .5s}
@keyframes flash{0%{transform:scale(1)}50%{transform:scale(1.08)}100%{transform:scale(1)}}

/* ğŸ¯ ç§»åŠ¨ç«¯ä¼˜åŒ– - ç²¾ç®€å“åº”å¼ */
@media (max-width: 768px) {
  body{padding:2px}
  .stats-container{gap:3px;padding:0}
  .stat-card{padding:6px 3px;border-radius:6px;font-size:0.8rem}
  .stat-icon{font-size:1.2rem;margin-bottom:3px}
  .stat-number{font-size:0.9rem;margin-bottom:2px;font-weight:600;line-height:1}
  .stat-label{font-size:0.65rem;margin-bottom:3px;line-height:1.1}
  .progress-bar{height:2px;margin-bottom:3px}
  .growth-indicator{font-size:0.6rem}
  .live-indicator{font-size:0.5rem;top:4px;right:4px}
  .live-dot{width:4px;height:4px}
}

@media (max-width: 480px) {
  body{padding:1px}
  .stats-container{gap:2px}
  .stat-card{padding:5px 2px;border-radius:4px}
  .stat-icon{font-size:1rem;margin-bottom:2px}
  .stat-number{font-size:0.8rem;margin-bottom:1px}
  .stat-label{font-size:0.6rem;margin-bottom:2px;line-height:1}
  .progress-bar{height:2px;margin-bottom:2px}
  .growth-indicator{font-size:0.55rem}
  .live-indicator{font-size:0.45rem;top:3px;right:3px}
  .live-dot{width:3px;height:3px}
}

@media (max-width: 375px) {
  body{padding:1px}
  .stats-container{gap:1px}
  .stat-card{padding:4px 1px;border-radius:3px}
  .stat-icon{font-size:0.9rem;margin-bottom:1px}
  .stat-number{font-size:0.7rem;margin-bottom:1px}
  .stat-label{font-size:0.5rem;margin-bottom:1px;line-height:1}
  .progress-bar{height:1px;margin-bottom:1px}
  .growth-indicator{font-size:0.45rem}
  .live-indicator{font-size:0.4rem;top:2px;right:2px}
  .live-dot{width:3px;height:3px}
}
</style>
</head>

<body>
<div class="stats-container">
  <a class="stat-card members" href="https://c0uiiy15npu.feishu.cn/share/base/form/shrcnKdKrgumC9OtjQNXiC05r8e" target="_blank">
    <div class="live-indicator"><div class="live-dot"></div><span data-i18n="live">å®æ—¶</span></div>
    <div class="stat-icon" aria-label="ç¤¾åŒºæˆå‘˜">ğŸ‘¥</div>
    <div class="stat-number" id="members-count">121,884</div>
    <div class="stat-label" data-i18n="members">ç¤¾åŒºæˆå‘˜</div>
    <div class="progress-bar"><div class="progress-fill" style="width:85%"></div></div>
    <div class="growth-indicator">â†— <span id="members-growth">+25/å°æ—¶</span></div>
  </a>

  <a class="stat-card companies" href="https://c0uiiy15npu.feishu.cn/share/base/form/shrcnxRAVSwtEHD40UUUg1086Gf" target="_blank">
    <div class="live-indicator"><div class="live-dot"></div><span data-i18n="live">å®æ—¶</span></div>
    <div class="stat-icon" aria-label="åˆ›ä¸šå…¬å¸ä¸æŠ•èµ„æœºæ„">ğŸ¢</div>
    <div class="stat-number" id="companies-count">10,761</div>
    <div class="stat-label" data-i18n="companies">åˆ›ä¸šå…¬å¸ä¸æŠ•èµ„æœºæ„</div>
    <div class="progress-bar"><div class="progress-fill" style="width:68%"></div></div>
    <div class="growth-indicator">â†— <span id="companies-growth">+8/å°æ—¶</span></div>
  </a>

  <a class="stat-card vip" href="https://c0uiiy15npu.feishu.cn/wiki/G0oMwUeNbiZkQBkX9iXcfMllnpe?from=from_copylink" target="_blank">
    <div class="live-indicator"><div class="live-dot"></div><span data-i18n="live">å®æ—¶</span></div>
    <div class="stat-icon" aria-label="æƒç›Šä¼šå‘˜">ğŸ’</div>
    <div class="stat-number" id="vip-count">1,102</div>
    <div class="stat-label" data-i18n="vip">æƒç›Šä¼šå‘˜</div>
    <div class="progress-bar"><div class="progress-fill" style="width:42%"></div></div>
    <div class="growth-indicator">â†— <span id="vip-growth">+3/å°æ—¶</span></div>
  </a>
</div><script>
/* === ä¼˜åŒ–çš„é«˜æ€§èƒ½è„šæœ¬ === */
const stats={members:{c:121884,g:25,m:150000},companies:{c:10761,g:8,m:20000},vip:{c:1102,g:3,m:2000}};
const translations={
  'zh-CN':{live:'å®æ—¶',members:'ä¸ªäººä¼šå‘˜',companies:'ä¼ä¸šä¼šå‘˜',vip:'æƒç›Šä¼šå‘˜',perHour:'/å°æ—¶'},
  'en':{live:'Live',members:'Individual Members',companies:'Corporate Members',vip:'VIP Members',perHour:'/hour'}
};
let currentLang='zh-CN',elements={},intervalId;

// ç¼“å­˜DOMå…ƒç´ 
function cacheElements(){
  elements={
    membersCount:document.getElementById('members-count'),
    companiesCount:document.getElementById('companies-count'),
    vipCount:document.getElementById('vip-count'),
    membersGrowth:document.getElementById('members-growth'),
    companiesGrowth:document.getElementById('companies-growth'),
    vipGrowth:document.getElementById('vip-growth'),
    progressFills:document.querySelectorAll('.progress-fill'),
    liveSpans:document.querySelectorAll('.live-indicator span'),
    labels:document.querySelectorAll('.stat-label'),
    icons:document.querySelectorAll('.stat-icon')
  };
}

function updateLang(lang){
  if(!translations[lang])lang='zh-CN';
  currentLang=lang;
  document.documentElement.lang=lang;
  const t=translations[lang];
  elements.liveSpans.forEach(el=>el.textContent=t.live);
  elements.labels[0].textContent=t.members;
  elements.labels[1].textContent=t.companies;
  elements.labels[2].textContent=t.vip;
  elements.icons[0].setAttribute('aria-label',t.members);
  elements.icons[1].setAttribute('aria-label',t.companies);
  elements.icons[2].setAttribute('aria-label',t.vip);
  paint();
}

function paint(){
  const t=translations[currentLang];
  elements.membersCount.textContent=stats.members.c.toLocaleString();
  elements.companiesCount.textContent=stats.companies.c.toLocaleString();
  elements.vipCount.textContent=stats.vip.c.toLocaleString();
  elements.membersGrowth.textContent=`+${stats.members.g}${t.perHour}`;
  elements.companiesGrowth.textContent=`+${stats.companies.g}${t.perHour}`;
  elements.vipGrowth.textContent=`+${stats.vip.g}${t.perHour}`;
  updateBars();
}

function flash(el){el.classList.add('increase-animation');setTimeout(()=>el.classList.remove('increase-animation'),500)}

function updateBars(){
  const maxGrowthRate=Math.max(stats.members.g,stats.companies.g,stats.vip.g);
  const rates=[stats.members.g,stats.companies.g,stats.vip.g];
  elements.progressFills.forEach((fill,i)=>fill.style.width=Math.min(rates[i]/maxGrowthRate*100,100)+'%');
}

// æ™ºèƒ½å¢é•¿ç®—æ³•
function loop(){
  const counters=[elements.membersCount,elements.companiesCount,elements.vipCount];
  const now=Date.now();
  const isActive=document.visibilityState==='visible';
  
  if(!isActive)return; // é¡µé¢ä¸å¯è§æ—¶æš‚åœæ›´æ–°
  
  Object.entries(stats).forEach(([k,v],i)=>{
    // åŸºäºæ—¶é—´çš„åŠ¨æ€æ¦‚ç‡ï¼Œé¿å…è¿‡äºé¢‘ç¹
    const timeFactor=Math.sin(now/30000)*0.3+0.7; // 30ç§’å‘¨æœŸ
    const probability=0.3*timeFactor;
    
    if(Math.random()<probability){
      const increment=Math.ceil(v.g*(0.8+Math.random()*0.4));
      v.c=Math.min(v.c+increment,v.m); // ä¸è¶…è¿‡æœ€å¤§å€¼
      flash(counters[i]);
    }
  });
  paint();
}

// åˆå§‹åŒ–å’Œæ¸…ç†
function init(){
  cacheElements();
  const params=new URLSearchParams(location.search);
  updateLang(params.get('lang')||'zh-CN');
  intervalId=setInterval(loop,60000);
  adjustIframeHeight();
}

function cleanup(){
  if(intervalId){clearInterval(intervalId);intervalId=null;}
}

// ä¼˜åŒ–çš„iframeé«˜åº¦è°ƒæ•´
function adjustIframeHeight(){
  const container=document.querySelector('.stats-container');
  if(!container)return;
  const containerHeight=container.scrollHeight;
  const bodyPadding=parseInt(getComputedStyle(document.body).padding)*2;
  const isMobile=window.innerWidth<=768;
  const finalHeight=containerHeight+bodyPadding+(isMobile?8:20);
  window.parent.postMessage({type:'adjustHeight',height:Math.max(finalHeight,isMobile?80:120)},'*');
}

// äº‹ä»¶ç›‘å¬
window.addEventListener('message',e=>{
  if(e.data?.type==='setLang')updateLang(e.data.lang);
});
window.addEventListener('load',init);
window.addEventListener('resize',adjustIframeHeight);
window.addEventListener('beforeunload',cleanup);
document.addEventListener('visibilitychange',()=>{
  if(document.visibilityState==='visible')paint(); // é‡æ–°è·å¾—ç„¦ç‚¹æ—¶åˆ·æ–°
});</script></body></html>
